!function r(o,i,a){function s(e,t){if(!i[e]){if(!o[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(c)return c(e,!0);throw(t=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",t}n=i[e]={exports:{}},o[e][0].call(n.exports,function(t){return s(o[e][1][t]||t)},n,n.exports,r,o,i,a)}return i[e].exports}for(var c="function"==typeof require&&require,t=0;t<a.length;t++)s(a[t]);return s}({1:[function(t,n,r){!function(j){!function(){var t,e;t=this,e=function(){function t(t){return i(m(t))}var g=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)},r=b,e=m,n=i,o=v,u=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function m(t){for(var e=[],n=0,r=0,o="";null!=(s=u.exec(t));){var i,a,s,c=s[0],h=s[1],p=s.index;o+=t.slice(r,p),r=p+c.length,h?o+=h[1]:(o&&(e.push(o),o=""),p=s[2],c=s[3],h=s[4],i=s[5],a=s[6],s=s[7],e.push({name:c||n++,prefix:p||"",delimiter:c=p||"/",optional:"?"===a||"*"===a,repeat:"+"===a||"*"===a,pattern:(h||i||(s?".*":"[^"+c+"]+?")).replace(/([=!:$\/()])/g,"\\$1")}))}return r<t.length&&(o+=t.substr(r)),o&&e.push(o),e}function i(c){for(var h=new Array(c.length),t=0;t<c.length;t++)"object"==typeof c[t]&&(h[t]=new RegExp("^"+c[t].pattern+"$"));return function(t){for(var e="",n=t||{},r=0;r<c.length;r++){var o=c[r];if("string"==typeof o)e+=o;else{var i,a=n[o.name];if(null==a){if(o.optional)continue;throw new TypeError('Expected "'+o.name+'" to be defined')}if(g(a)){if(!o.repeat)throw new TypeError('Expected "'+o.name+'" to not repeat, but received "'+a+'"');if(0===a.length){if(o.optional)continue;throw new TypeError('Expected "'+o.name+'" to not be empty')}for(var s=0;s<a.length;s++){if(i=encodeURIComponent(a[s]),!h[r].test(i))throw new TypeError('Expected all "'+o.name+'" to match "'+o.pattern+'", but received "'+i+'"');e+=(0===s?o.prefix:o.delimiter)+i}}else{if(i=encodeURIComponent(a),!h[r].test(i))throw new TypeError('Expected "'+o.name+'" to match "'+o.pattern+'", but received "'+i+'"');e+=o.prefix+i}}}return e}}function p(t){return t.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")}function w(t,e){return t.keys=e,t}function y(t){return t.sensitive?"":"i"}function v(t,e){for(var n=(e=e||{}).strict,r=!1!==e.end,o="",i=t[t.length-1],i="string"==typeof i&&/\/$/.test(i),a=0;a<t.length;a++){var s,c,h=t[a];"string"==typeof h?o+=p(h):(s=p(h.prefix),c=h.pattern,h.repeat&&(c+="(?:"+s+c+")*"),o+=c=h.optional?s?"(?:"+s+"("+c+"))?":"("+c+")?":s+"("+c+")")}return n||(o=(i?o.slice(0,-2):o)+"(?:\\/(?=$))?"),o+=r?"$":n&&i?"":"(?=\\/|$)",new RegExp("^"+o,y(e))}function b(t,e,n){if(g(e=e||[])?n=n||{}:(n=e,e=[]),t instanceof RegExp){var r=t,o=e,i=r.source.match(/\((?!\?)/g);if(i)for(var a=0;a<i.length;a++)o.push({name:a,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return w(r,o)}if(g(t)){for(var s=t,c=e,h=n,p=[],u=0;u<s.length;u++)p.push(b(s[u],c,h).source);return w(new RegExp("(?:"+p.join("|")+")",y(h)),c)}for(var l=e,r=n,f=m(e=t),e=v(f,r),d=0;d<f.length;d++)"string"!=typeof f[d]&&l.push(f[d]);return w(e,l)}r.parse=e,r.compile=t,r.tokensToFunction=n,r.tokensToRegExp=o;var a,s="undefined"!=typeof document,c="undefined"!=typeof window,h="undefined"!=typeof history,l=void 0!==j,f=s&&document.ontouchstart?"touchstart":"click",d=c&&!(!window.history.location&&!window.location);function _(){this.callbacks=[],this.exits=[],this.current="",this.len=0,this._decodeURLComponents=!0,this._base="",this._strict=!1,this._running=!1,this._hashbang=!1,this.clickHandler=this.clickHandler.bind(this),this._onpopstate=this._onpopstate.bind(this)}function x(t,e){if("function"==typeof t)return x.call(this,"*",t);if("function"==typeof e)for(var n=new E(t,null,this),r=1;r<arguments.length;++r)this.callbacks.push(n.middleware(arguments[r]));else"string"==typeof t?this["string"==typeof e?"redirect":"show"](t,e):this.start(t)}function R(t,e,n){var n=this.page=n||x,r=n._window,o=n._hashbang,i=n._getBase(),a=(t="/"===t[0]&&0!==t.indexOf(i)?i+(o?"#!":"")+t:t).indexOf("?"),i=(this.canonicalPath=t,new RegExp("^"+i.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")));this.path=t.replace(i,"")||"/",o&&(this.path=this.path.replace("#!","")||"/"),this.title=s&&r.document.title,this.state=e||{},this.state.path=t,this.querystring=~a?n._decodeURLEncodedURIComponent(t.slice(a+1)):"",this.pathname=n._decodeURLEncodedURIComponent(~a?t.slice(0,a):t),this.params={},this.hash="",o||~this.path.indexOf("#")&&(i=this.path.split("#"),this.path=this.pathname=i[0],this.hash=n._decodeURLEncodedURIComponent(i[1])||"",this.querystring=this.querystring.split("#")[0])}function E(t,e,n){n=this.page=n||U,e=e||{};e.strict=e.strict||n._strict,this.path="*"===t?"(.*)":t,this.method="GET",this.regexp=r(this.path,this.keys=[],e)}_.prototype.configure=function(t){t=t||{},this._window=t.window||c&&window,this._decodeURLComponents=!1!==t.decodeURLComponents,this._popstate=!1!==t.popstate&&c,this._click=!1!==t.click&&s,this._hashbang=!!t.hashbang,t=this._window;this._popstate?t.addEventListener("popstate",this._onpopstate,!1):c&&t.removeEventListener("popstate",this._onpopstate,!1),this._click?t.document.addEventListener(f,this.clickHandler,!1):s&&t.document.removeEventListener(f,this.clickHandler,!1),this._hashbang&&c&&!h?t.addEventListener("hashchange",this._onpopstate,!1):c&&t.removeEventListener("hashchange",this._onpopstate,!1)},_.prototype.base=function(t){if(0===arguments.length)return this._base;this._base=t},_.prototype._getBase=function(){var t,e=this._base;return e||(t=c&&this._window&&this._window.location,c&&this._hashbang&&t&&"file:"===t.protocol&&(e=t.pathname)),e},_.prototype.strict=function(t){if(0===arguments.length)return this._strict;this._strict=t},_.prototype.start=function(t){var e,t=t||{};this.configure(t),!1!==t.dispatch&&(this._running=!0,d&&(e=this._window.location,e=this._hashbang&&~e.hash.indexOf("#!")?e.hash.substr(2)+e.search:this._hashbang?e.search+e.hash:e.pathname+e.search+e.hash),this.replace(e,null,!0,t.dispatch))},_.prototype.stop=function(){var t;this._running&&(this.current="",this.len=0,this._running=!1,t=this._window,this._click&&t.document.removeEventListener(f,this.clickHandler,!1),c&&t.removeEventListener("popstate",this._onpopstate,!1),c)&&t.removeEventListener("hashchange",this._onpopstate,!1)},_.prototype.show=function(t,e,n,r){t=new R(t,e,this),e=this.prevContext;return this.prevContext=t,this.current=t.path,!1!==n&&this.dispatch(t,e),!1!==t.handled&&!1!==r&&t.pushState(),t},_.prototype.back=function(t,e){var n,r=this;0<this.len?(n=this._window,h&&n.history.back(),this.len--):t?setTimeout(function(){r.show(t,e)}):setTimeout(function(){r.show(r._getBase(),e)})},_.prototype.redirect=function(t,e){var n=this;"string"==typeof t&&"string"==typeof e&&x.call(this,t,function(t){setTimeout(function(){n.replace(e)},0)}),"string"==typeof t&&void 0===e&&setTimeout(function(){n.replace(t)},0)},_.prototype.replace=function(t,e,n,r){t=new R(t,e,this),e=this.prevContext;return this.prevContext=t,this.current=t.path,t.init=n,t.save(),!1!==r&&this.dispatch(t,e),t},_.prototype.dispatch=function(e,n){var r=0,o=0,i=this;function a(){var t=i.callbacks[r++];if(e.path===i.current)return t?void t(e,a):function(t){var e;t.handled||(e=this._window,(this._hashbang?d&&this._getBase()+e.location.hash.replace("#!",""):d&&e.location.pathname+e.location.search)!==t.canonicalPath&&(this.stop(),t.handled=!1,d)&&(e.location.href=t.canonicalPath))}.call(i,e);e.handled=!1}(n?function t(){var e=i.exits[o++];if(!e)return a();e(n,t)}:a)()},_.prototype.exit=function(t,e){if("function"==typeof t)return this.exit("*",t);for(var n=new E(t,null,this),r=1;r<arguments.length;++r)this.exits.push(n.middleware(arguments[r]))},_.prototype.clickHandler=function(t){if(1===this._which(t)&&!(t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)){var e,n,r,o=t.target,i=t.path||(t.composedPath?t.composedPath():null);if(i)for(var a=0;a<i.length;a++)if(i[a].nodeName&&"A"===i[a].nodeName.toUpperCase()&&i[a].href){o=i[a];break}for(;o&&"A"!==o.nodeName.toUpperCase();)o=o.parentNode;o&&"A"===o.nodeName.toUpperCase()&&(n="object"==typeof o.href&&"SVGAnimatedString"===o.href.constructor.name,o.hasAttribute("download")||"external"===o.getAttribute("rel")||(e=o.getAttribute("href"),!this._hashbang&&this._samePath(o)&&(o.hash||"#"===e))||e&&-1<e.indexOf("mailto:")||(n?o.target.baseVal:o.target)||(n||this.sameOrigin(o.href))&&(e="/"!==(e=n?o.href.baseVal:o.pathname+o.search+(o.hash||""))[0]?"/"+e:e,n=e=l&&e.match(/^\/[a-zA-Z]:\//)?e.replace(/^\/[a-zA-Z]:\//,"/"):e,r=this._getBase(),0===e.indexOf(r)&&(e=e.substr(r.length)),this._hashbang&&(e=e.replace("#!","")),!r||n!==e||d&&"file:"===this._window.location.protocol)&&(t.preventDefault(),this.show(n)))}},_.prototype._onpopstate=(a=!1,c?(s&&"complete"===document.readyState?a=!0:window.addEventListener("load",function(){setTimeout(function(){a=!0},0)}),function(t){var e;a&&(t.state?(e=t.state.path,this.replace(e,t.state)):d&&(e=this._window.location,this.show(e.pathname+e.search+e.hash,void 0,void 0,!1)))}):function(){}),_.prototype._which=function(t){return null==(t=t||c&&this._window.event).which?t.button:t.which},_.prototype._toURL=function(t){var e=this._window;return"function"==typeof URL&&d?new URL(t,e.location.toString()):s?((e=e.document.createElement("a")).href=t,e):void 0},_.prototype.sameOrigin=function(t){var e;return!(!t||!d||(t=this._toURL(t),(e=this._window.location).protocol!==t.protocol)||e.hostname!==t.hostname||e.port!==t.port&&(""!==e.port||80!=t.port&&443!=t.port))},_.prototype._samePath=function(t){var e;return!!d&&(e=this._window.location,t.pathname===e.pathname)&&t.search===e.search},_.prototype._decodeURLEncodedURIComponent=function(t){return"string"==typeof t&&this._decodeURLComponents?decodeURIComponent(t.replace(/\+/g," ")):t},R.prototype.pushState=function(){var t=this.page,e=t._window,n=t._hashbang;t.len++,h&&e.history.pushState(this.state,this.title,n&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},R.prototype.save=function(){var t=this.page;h&&t._window.history.replaceState(this.state,this.title,t._hashbang&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},E.prototype.middleware=function(n){var r=this;return function(t,e){if(r.match(t.path,t.params))return t.routePath=r.path,n(t,e);e()}},E.prototype.match=function(t,e){var n=this.keys,r=t.indexOf("?"),r=~r?t.slice(0,r):t,o=this.regexp.exec(decodeURIComponent(r));if(!o)return!1;delete e[0];for(var i=1,a=o.length;i<a;++i){var s=n[i-1],c=this.page._decodeURLEncodedURIComponent(o[i]);void 0===c&&hasOwnProperty.call(e,s.name)||(e[s.name]=c)}return!0};var U=function t(){var e=new _;function n(){return x.apply(e,arguments)}return n.callbacks=e.callbacks,n.exits=e.exits,n.base=e.base.bind(e),n.strict=e.strict.bind(e),n.start=e.start.bind(e),n.stop=e.stop.bind(e),n.show=e.show.bind(e),n.back=e.back.bind(e),n.redirect=e.redirect.bind(e),n.replace=e.replace.bind(e),n.dispatch=e.dispatch.bind(e),n.exit=e.exit.bind(e),n.configure=e.configure.bind(e),n.sameOrigin=e.sameOrigin.bind(e),n.clickHandler=e.clickHandler.bind(e),n.create=t,Object.defineProperty(n,"len",{get:function(){return e.len},set:function(t){e.len=t}}),Object.defineProperty(n,"current",{get:function(){return e.current},set:function(t){e.current=t}}),n.Context=R,n.Route=E,n}(),e=U;return e.default=U,e},"object"==typeof r&&void 0!==n?n.exports=e():"function"==typeof define&&define.amd?define(e):t.page=e()}.call(this)}.call(this,t("_process"))},{_process:2}],2:[function(t,e,n){var r,o,e=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}try{r="function"==typeof setTimeout?setTimeout:i}catch(t){r=i}try{o="function"==typeof clearTimeout?clearTimeout:a}catch(t){o=a}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return(r=setTimeout)(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}var c,h=[],p=!1,u=-1;function l(){p&&c&&(p=!1,c.length?h=c.concat(h):u=-1,h.length)&&f()}function f(){if(!p){for(var t=s(l),e=(p=!0,h.length);e;){for(c=h,h=[];++u<e;)c&&c[u].run();u=-1,e=h.length}c=null,p=!1,!function(e){if(o===clearTimeout)return clearTimeout(e);if((o===a||!o)&&clearTimeout)return(o=clearTimeout)(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function g(){}e.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new d(t,e)),1!==h.length||p||s(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=g,e.addListener=g,e.once=g,e.off=g,e.removeListener=g,e.removeAllListeners=g,e.emit=g,e.prependListener=g,e.prependOnceListener=g,e.listeners=function(t){return[]},e.binding=function(t){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(t){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],3:[function(g,t,e){t.exports=function(s,c){var h=c.$,p=s.opts,u=s.util,l=s.handlebars.pageLang,f=p.log,d=h("[data-render-layout]");return{start:function(){f("jqueryview start"),s.on("nav",t),s.on("loaded",t),s.on("updatedText",e)},stop:function(){f("jqueryview stop"),s.off("nav",t),s.off("loaded",t),s.off("updatedText",e)}};function t(t,e,n,r){f("jqueryview nav %s%s%s %s",t,e||"",n||"",!!r);var o,i,r=r||!t,a=(t=t||location.pathname,e=e||r&&location.search||"",n=n||r&&location.hash||"",s.findPage(t));return a?(o=u.unPrefix(location.pathname,p.staticRoot),(i=s.findPage(o))?void(!r&&a===i||(s.req={query:e?g("querystring").parse(e.slice(1)):{}},d.length&&(r||(r=a,(i=i)&&i.fixlayout)||l(i)!==l(r)||(i=d.attr("data-render-layout")||"main-layout",s.layoutTemplate(r)!==i))?(r=s.layoutTemplate(a),d.html(s.renderLayout(a)),d.attr("data-render-layout",r),f("jqueryview updateLayout",t,e,n),s.emit("update-view",t,e,n,c,d)):(i=h("[data-render-page]")).length?(i.html(s.renderPage(a)),i.attr("data-render-page",a._href),f("jqueryview updatePage:",t,e,n),s.emit("update-view",t,e,n,c,i)):s.emit("notify","Oops, jqueryview cannot update page "+t))):s.emit("notify","Oops, jqueryview cannot find current page object "+o)):s.emit("notify","Oops, jqueryview cannot find new page object "+t)}function e(t){var e=s.fragment$[t];if(!e)return s.emit("notify","Oops, jqueryview cannot find fragment: "+t);var n=h('[data-render-html="'+t+'"]');if(!n.length)return s.emit("notify","Oops, jqueryview cannot update html for fragment: "+t);n.html(s.renderHtml(e));t=u.unPrefix(location.pathname,p.staticRoot);f("jqueryview updateHtml",t,location.search,location.hash),s.emit("update-view",t,location.search,location.hash,c,n)}}},{querystring:7}],4:[function(t,e,n){$(function(){var n=window.parent.generator;if(!n)throw new Error("cannot bind preview to pub-generator");var r=n.util,o=n.opts,i=o.log,a=o.appUrl;window.generator=n,t("./jqueryview")(n,window).start();var s=(s=window.parent.location.search?t("querystring").parse(window.parent.location.search.slice(1)).page:"")||r.unPrefix(r.unPrefix(window.parent.location.pathname,o.staticRoot),o.editorPrefix);window.pager=t("page"),window.pager("*",function(t){var e=t.path,e=r.unPrefix(e,a);e=(e=r.unPrefix(e,o.staticRoot)).split("?")[0],i("pager nav %s%s%s%s",e,t.querystring?"?"+t.querystring:"",t.hash?"#"+t.hash:"",s?" (forceReload)":""),n.emit("nav",e,t.querystring?"?"+t.querystring:"",t.hash?"#"+t.hash:"",!!s),s=void 0}),window.pager({dispatch:!1}),s&&pager.show(s),window.onGenerator&&window.onGenerator(n)})},{"./jqueryview":3,page:1,querystring:7}],5:[function(t,e,n){e.exports=function(t,e,n,r){e=e||"&",n=n||"=";var o={};if("string"==typeof t&&0!==t.length){var i=/\+/g,e=(t=t.split(e),1e3),a=(r&&"number"==typeof r.maxKeys&&(e=r.maxKeys),t.length);0<e&&e<a&&(a=e);for(var s=0;s<a;++s){var c,h=t[s].replace(i,"%20"),p=h.indexOf(n),p=0<=p?(c=h.substr(0,p),h.substr(p+1)):(c=h,""),h=decodeURIComponent(c),p=decodeURIComponent(p);Object.prototype.hasOwnProperty.call(o,h)?u(o[h])?o[h].push(p):o[h]=[o[h],p]:o[h]=p}}return o};var u=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],6:[function(t,e,n){function i(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}}e.exports=function(n,r,o,t){return r=r||"&",o=o||"=","object"==typeof(n=null===n?void 0:n)?s(c(n),function(t){var e=encodeURIComponent(i(t))+o;return a(n[t])?s(n[t],function(t){return e+encodeURIComponent(i(t))}).join(r):e+encodeURIComponent(i(n[t]))}).join(r):t?encodeURIComponent(i(t))+o+encodeURIComponent(i(n)):""};var a=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function s(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var c=Object.keys||function(t){var e,n=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.push(e);return n}},{}],7:[function(t,e,n){n.decode=n.parse=t("./decode"),n.encode=n.stringify=t("./encode")},{"./decode":5,"./encode":6}]},{},[4]);