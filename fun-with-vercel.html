<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="robots" content="noindex, nofollow">

<!-- html generated by pub-server from markdown /fun-with-vercel.md -->

<title>Fun with Vercel</title>
<link rel="stylesheet" href="./css/pubblog.css">
<link rel="stylesheet" href="./css/open-sans.css">
<link rel="stylesheet" href="./css/font-awesome.css">
<link rel="stylesheet" href="./css/highlight-9.18.1-github.css">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>

<div data-render-layout="main-layout">
<header>
<div id="doctitle"><h1 id="jldecuk"><a href="./">jldec.uk</a></h1>
</div>
<div id="topmenu"><div data-render-html="/#topmenu">&nbsp;</div></div>
</header>

<div id="navicon" onclick=""><p><span class="fa fa-fw fa-2x">&#xf01a;</span></p>

<nav id="toc">
<ul>
<li><strong><a href="./">Home</a></strong></li>
<li><a href="./fun-with-vercel">Fun with Vercel</a></li>
<li><a href="./first-steps-using-cloudflare-pages">First steps using Cloudflare Pages</a></li>
<li><a href="./migrating-from-cjs-to-esm">Migrating from CommonJS to ESM</a></li>
<li><a href="./forays-from-node-to-rust">Forays from Node to Rust</a></li>
<li><a href="./github-actions-101">GitHub Actions 101</a></li>
<li><a href="./a-web-for-everyone">A Web for Everyone</a></li>
<li><a href="./why-serverless-at-the-edge">Why Serverless at the Edge?</a></li>
<li><a href="./spring-boot-101">Spring Boot 101</a></li>
<li><a href="./why-the-web-needs-better-html-editing-components">Why the Web needs better HTML editing components</a></li>
<li><a href="./about">About me</a></li>
</ul>
</nav>
</div>

<div id="title" style='background-image:url("images/library.jpg");'>
  <div class="title">Fun with Vercel</div>
  <div class="subtitle"></div>
</div>

<div id="main" onclick="">
<div id="content">

<div data-render-page="/fun-with-vercel">
<span class="permalink"><a class="permalink" href="./fun-with-vercel" title="Link to this post.">&#xf0c1;</a></span><span class="date">2021-02-07</span>

<div >
<div data-render-html="/fun-with-vercel"><h2 id="vercel">Vercel</h2>
<p>Last week I wrote about <a href="first-steps-using-cloudflare-pages">First Steps Using Cloudflare Pages</a>.</p>
<p><a href="https://vercel.com/home" target="_blank" rel="noopener">Vercel</a> is another leader in the trend toward static hosting, serverless, and <a href="./why-serverless-at-the-edge">edge compute</a>.</p>
<h2 id="jldecfun-ðŸ¤ª"><a href="https://jldec.fun/fun-with-vercel" target="_blank" rel="noopener">jldec.fun</a> ðŸ¤ª</h2>
<p>This is a walkthrough of how I deployed <a href="https://jldec.fun/" target="_blank" rel="noopener">jldec.fun</a> using the <a href="https://vercel.com/docs" target="_blank" rel="noopener">Vercel platform</a>.</p>
<p>Markdown source files live in the same repo on <a href="https://github.com/jldec/cloudflare-pages-test" target="_blank" rel="noopener">GitHub</a> as before.</p>
<p>The Vercel signup starts a New Project workflow <em>(this could be simplified.)</em></p>
<p><img src="./images/vercel-new-project.png" alt="Vercel new project workflow with link to GitHub"></p>
<p>I clicked on &#39;Continue with GitHub&#39;, and then chose the first option in the dropdown below.</p>
<p><img src="./images/vercel-add-github-account.png" alt="Vercel add GitHub account dropdown"></p>
<p>This led to the GitHub form for granting repo access to the &#39;Vercel&#39; GitHub app. (<em>Look for it later in your <a href="https://github.com/settings/installations" target="_blank" rel="noopener">GitHub Settings</a> to add more repos, or to revoke access.</em>)</p>
<p><img src="./images/vercel-github-app.png" alt="Authorize Vercel app on GitHub"></p>
<p>Back on Vercel, I selected my repo and used my &#39;Personal Account&#39; scope. Team scope requires a paid plan.</p>
<p><img src="./images/vercel-select-project-scope.png" alt="Select scope for the new project"></p>
<p>I continued with the default (root) project directory within the repo.</p>
<p><img src="./images/vercel-select-directory.png" alt="Select project direcotry inside repo"></p>
<p>In the last form of the Import Project flow, Project Name defaults to the name of the repo, so I changed that to &#39;jldec-fun&#39;. I also configured a build command and an output directory.</p>
<p>I didn&#39;t really need encrypted <a href="https://vercel.com/docs/environment-variables" target="_blank" rel="noopener">environment variables</a> here, but this step doesn&#39;t offer an alternative, so I made a note to change it later.</p>
<p><img src="./images/vercel-configure-build-jldec-fun.png" alt="Configure the build command and output directory"></p>
<p>Submitting the form triggered the first build, followed by a nice confetti shower. ðŸŽ‰</p>
<p><img src="./images/vercel-confetti-jldec-fun.png" alt="First build and deploy confetti celebration"></p>
<p>Unfortunately, visiting the site revealed a problem. Vercel does not automatically serve files stored with an &#39;.html&#39; extension, when a request comes in <em>without</em> any extension.</p>
<p><img src="./images/vercel-without-clean-url-setting.png" alt="Page not found when trying to browse toURL without extension"></p>
<p>The fix requires <a href="https://vercel.com/docs/configuration#project/clean-urls" target="_blank" rel="noopener">cleanUrls</a> to be set in the <code>vercel.json</code> file at the project root.</p>
<pre><code class="language-json">{
  &quot;cleanUrls&quot;: true
}
</code></pre>
<p>Adding this setting fixed my 404 problem.</p>
<p>The same config file would also be useful for other common static hosting requirements like <a href="https://vercel.com/docs/configuration#project/redirects" target="_blank" rel="noopener">redirects</a>, HTTP <a href="https://vercel.com/docs/configuration#project/headers" target="_blank" rel="noopener">headers</a>, and the treatment of URLs with a <a href="https://vercel.com/docs/configuration#project/trailing-slash" target="_blank" rel="noopener">trailing slash</a>.</p>
<p>Back in the well-designed Vercel Settings UI, I was able to change my environment variables to plaintext. I liked the ability to set different values for preview builds.</p>
<p><img src="./images/vercel-environment-settings.png" alt="Dashboard environment settings"></p>
<p>When I added my domain name, the form helpfully recommended configuring an IP address.</p>
<p><img src="./images/vercel-domain-setting.png" alt="Dashboard domain settings"></p>
<p>Once the DNS record was in place, the domain configuration changed to &#39;Valid&#39;.</p>
<p><img src="./images/vercel-domain-setting-fixed.png" alt="Dashboard domain settings fixed"></p>
<blockquote>
<p>Tada!</p>
</blockquote>
<p><a href="https://jldec.fun/fun-with-vercel" target="_blank" rel="noopener">jldec.fun</a> is deployed from the <code>main</code> branch on <a href="https://github.com/jldec/cloudflare-pages-test" target="_blank" rel="noopener">GitHub</a>. Commits to any other branch will trigger a preview deployment on a different URL.</p>
<p><img src="./images/vercel-post.png" alt="screenshot of jldec.fun"></p>
<blockquote>
<p>Static websites are awesome!<br><span class="fa fa-2x">&#xf087;</span></p>
</blockquote>
<p><em>To leave a comment<br>please visit <a href="https://dev.to/jldec/fun-with-vercel-3b6e" target="_blank" rel="noopener">dev.to/jldec</a></em></p>
</div>
</div>


</div><!--page-->

<div id="credit"><p><span class="fa">&#xf004;</span> powered by <a href="https://jldec.github.io/pub-doc/" target="_blank" rel="noopener">pub-server</a> and <a href="https://github.com/jldec/pub-theme-pubblog" target="_blank" rel="noopener">pub-theme-pubblog</a></p>
</div>

</div>
</div>

</div><!--layout-->

<script>window.pubRef = {"href":"/fun-with-vercel","relPath":"."};</script>
<script src="./js/jquery-1.12.4.min.js" ></script>
<script src="./js/highlight-9.18.1.min.js" ></script>
<script src="./js/pub-pkg-highlight.js" ></script>
<script src="./pub/pub-ux.js" ></script>
<!-- copyright -->
</body>
</html>
